<!DOCTYPE html>
<html lang="en">
<head>
    <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
    <meta charset="utf-8" />
    <link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
    <link rel="icon" type="image/png" href="../assets/img/favicon.png">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Administration</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />

    <!--     Fonts and icons     -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />

  <!-- CSS Files -->
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/material-kit.css" rel="stylesheet"/>
  <link href="../assets/css/demo.css" rel="stylesheet" />

    
    <style>
    pre.prettyprint{
        background-color: #eee;
        border: 0px;
        margin-bottom: 60px;
        margin-top: 30px;
        padding: 20px;
        text-align: left;
    }
    .atv, .str{
        color: #05AE0E;
    }
    .tag, .pln, .kwd{
        color: #3472F7;
    }
    .atn{
        color: #2C93FF;
    }
    .pln{
        color: #333;
    }
    .error {
          color: red;
          margin-left: 20px;
        }
    .com{
        color: #999;
    }
    .space-top{
        margin-top: 50px;
    }
    .btn-primary .caret{
        border-top-color: #3472F7;
        color: #3472F7;
    }
    .area-line{
        border: 1px solid #999;
        border-left: 0;
        border-right: 0;
        color: #666;
        display: block;
        margin-top: 20px;
        padding: 8px 0;
        text-align: center;
    }
    .area-line a{
        color: #666;
    }
    .container-fluid{
        padding-right: 15px;
        padding-left: 15px;
    }
    .table-shopping .td-name{
      min-width: 130px;
    }

  </style>
    <style type="text/css">
        #whole {
            width: 100%;
            height: 1000px;
        }
        #logout {
            float: right;
            margin-top: 4px;
            margin-right: 5px;
        }
        #welcome {
            float: left;
            width: 1100px;
        }
        .error {
          color: red;
          margin-left: 20px;
        }
        #removallist {
          margin-left: 60px;
        }
    </style>
    </head>


<body class="components-page">
<div class="wrapper">
  <div class="header header-filter" style="background-image: url('https://images.unsplash.com/photo-1423655156442-ccc11daa4e99?crop=entropy&dpr=2&fit=crop&fm=jpg&h=750&ixjsv=2.1.0&ixlib=rb-0.3.5&q=50&w=1450');">
    <div class="container">
      <div class="row">
        <div class="col-md-6 col-md-offset-3">
          <h1 class="title text-center">Hello, World.</h1>
        </div>
      </div>
    </div>
  </div>

    <div class="main main-raised">
        <div class="section">
    <div class="container">
        <div class="row">
            <div class="col-md-12 col-md-offset-0">
                <div class="tim-container">
                  <script type="text/javascript">
                var data = <%-JSON.stringify(users)%>;
                  </script>
                  <h2 class="text-center">User List</h2>
                  <div class="tim-row" id="tables-row">
        <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th class="text-center">#</th>
                            <th>IP</th>
                            <th>Name</th>
                            <th>Contact</th>
                            <th>Designation</th>
                            <th>Email</th>
                            <th class="text-right">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% for(var i=0; i<users.length; i++) {%>
                       <tr>
                         <td class="text-center">
                           <%= users[i].userID %>
                         </td>
                         <td>
                           <%= users[i].ipAddr %>
                         </td>
                         <td>
                           <%= users[i].name %>
                         </td>
                         <td>
                           <%= users[i].contact %>
                         </td>
                         <td>
                           <%= users[i].designation %>
                         </td>
                         <td>
                           <%= users[i].email %>
                         </td>
                         <td class="td-actions text-right">
                                <form action="/removeuser" method="post">
                                   <!-- <button type="button" rel="tooltip" title="View Profile" class="btn btn-info btn-simple btn-xs">
                                    <i class="fa fa-user"></i>
                                </button>  -->
                                <!-- <button type="submit" rel="tooltip" title="Remove" class="btn btn-danger btn-simple btn-xs">
                                    <i class="fa fa-times"></i>
                                </button> -->
                                <input type="hidden" id="ID" name="ID" value=<%= users[i].userID %> >
                             <input type="hidden" id="I" name="I" value=<%= users[i].id %> >
                             <input type="hidden" id="ip_addr" name="ip_addr" value=<%= users[i].ipAddr %> >

                                 <button type="submit" rel="tooltip" title="Remove" class="btn btn-danger btn-simple btn-xs">
                                    <i class="fa fa-times"></i>
                                </button> 
                              </form>
                            </td>
                       </tr>
                    <% } %>
                    </tbody>
                </table>
                </div> 
             <!-- </div> -->
             <!--  <div class="tim-row" id="modal-row"> -->
                  <!-- Button trigger modal -->
<p class="text-center"> <button class="btn btn-info btn-sm" data-toggle="modal" data-target="#myModal"> </p>
  Add user
</button>

               </div>
                <div class="tim-row" id="buttons-row">
                  <form action="/logout" method="post">
                  <p class="text-center">
                      <button type="submit" class="btn btn-danger">Logout</button>
                  </p>
                </form>
                 </div>

      
        
        </div>
        </div>
    </div>
    </div> 
  </div>
</div>
</div>
<!-- Modal Core -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
  <div class="modal-content">
    <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h4 class="modal-title text-center" id="myModalLabel">New user</h4>
    </div>
    <div class="modal-body">
    <form action="/adduser" method="POST">
          
            <div class="input-group">
                    <span class="input-group-addon">
                      <i class="material-icons">person</i>
                    </span>
                    <input required type="(?=.*\d)" name="userID" id="userID" class="form-control" placeholder="Unique ID...">
            </div><div class="error" id="uiderr"></div>
            <div class="input-group">
                    <span class="input-group-addon">
                      <i class="material-icons">face</i>
                    </span>
                    <input required type="text" name="user_name" id="user_name" class="form-control" placeholder="Name">
           </div>
           <div class="input-group">
                    <span class="input-group-addon">
                      <i class="material-icons">email</i>
                    </span>
                    <input required type="email" name="email" id="email" class="form-control" placeholder="E-mail">
           </div>
           <div class="input-group">
                    <span class="input-group-addon">
                      <i class="material-icons">phone</i>
                    </span>
                    <input required type="(?=.*\d).{10}" name="contact" id="contact" class="form-control" placeholder="Contact">
            </div>
            <div class="input-group">
                    <span class="input-group-addon">
                      <i class="material-icons">work</i>
                    </span>
                    <input required type="text" name="designation" id="designation" class="form-control" placeholder="Designation">
           </div><div class="error" id="desnerr"></div>
           <div class="input-group">
                    <span class="input-group-addon">
                      <i class="material-icons">code</i>
                    </span>
                    <input required type="^([0-9]{1,3}\.){3}[0-9]{1,3}$" name="ipaddr" id="ipaddr" class="form-control" placeholder="IP...">
            </div><div class="error" id="iperr"></div>
            <p class="text-center"> 
      <button type="button" class="btn btn-default btn-danger" data-dismiss="modal">Close</button> 
    <button type="submit" name="adduser" id="submit" class="btn btn-info btn-success">Save</button>
   </p>
        </form>
    </div>
  </div>
  </div>
</div>

</body>



  <!--   Core JS Files   -->
  <script src="../assets/js/jquery.min.js" type="text/javascript"></script>
  <script src="../assets/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="../assets/js/material.min.js"></script>

  <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
  <script src="../assets/js/nouislider.min.js" type="text/javascript"></script>

  <!--  Plugin for the Datepicker, full documentation here: http://www.eyecon.ro/bootstrap-datepicker/ -->
  <script src="../assets/js/bootstrap-datepicker.js" type="text/javascript"></script>

  <!-- Control Center for Material Kit: activating the ripples, parallax effects, scripts from the example pages etc -->
  <script src="../assets/js/material-kit.js" type="text/javascript"></script>

    </html>
   <script type="text/javascript">
   var usersVar = <%- JSON.stringify(users) %>;
   var designationsVar = <%- JSON.stringify(designations) %>;
     $('#ipaddr').on('keyup', function(){
        var text = $('#ipaddr').val();
        for(var i=0; i<usersVar.length;i++){
            var iprow = usersVar[i];
            if(iprow.ipAddr==text){
              $('#iperr').html('<b>IP Address Already In Use</b>');
              $("#submit").attr("disabled", "disabled");
              break;
            }else{
              $("#submit").removeAttr("disabled");
              $('#iperr').html('');
            }
          }
      });
     $('#userID').on('keyup', function(){
        var text = $('#userID').val();
        for(var i=0; i<usersVar.length;i++){
            var iprow = usersVar[i];
            if(iprow.userID==text){
              $('#uiderr').html('<b>User ID Already In Use</b>');
              $("#submit").attr("disabled", "disabled");
              break;
            }else{
              $("#submit").removeAttr("disabled");
              $('#uiderr').html('');
            }
          }
      });
     $('#designation').blur(function(){
         var text = $('#designation').val();
         var flag = false;
        for(var key in designationsVar){
            if(designationsVar.hasOwnProperty(key)){
                if(key == text){
                    flag = true;
                    break;
                }
            }            
          }
          if(!flag){
              $('#desnerr').html('<b>No Such Designation</b>');
              $("#submit").attr("disabled", "disabled");
            }else{
              $("#submit").removeAttr("disabled");
              $('#desnerr').html('');
            }
     });
     $('#submit').click(function(){
        var text = $('#ipaddr').val();
        for(var i=0; i<usersVar.length;i++){
            var iprow = usersVar[i];
            if(iprow.ipAddr==text){
              $('#iperr').html('<b>IP Address Already In Use</b>');
              $("#submit").attr("disabled", "disabled");
              break;
            }else{
              $("#submit").removeAttr("disabled");
              $('#iperr').html('');
            }
          }
          var text = $('#designation').val();
         var flag = false;
        for(var key in designationsVar){
            if(designationsVar.hasOwnProperty(key)){
                if(key == text){
                    flag = true;
                    break;
                }
            }            
          }
          if(!flag){
              $('#desnerr').html('<b>No Such Designation</b>');
              $("#submit").attr("disabled", "disabled");
            }else{
              $("#submit").removeAttr("disabled");
              $('#desnerr').html('');
            }
     });
   </script>