
<!doctype html>
<html lang="en">
<head>

	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="../assets/img/apple-icon.png">
	<link rel="icon" type="image/png" href="../assets/img/favicon.png">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>Assam Police</title>

	<meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />

	<!--     Fonts and icons     -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
	<link rel = "stylesheet" type = "text/css" href = "../assets/css/messagetab.css" />
	<!-- CSS Files -->
    <link href="../assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/material-kit.css" rel="stylesheet"/>
    <script src="/socket.io/socket.io.js"></script>
  <style>

  #sidebar_secondary2{
    height: 400px;
  } 
  #commentdiv{
    margin-top: 20px;
  } 
  #commentdiv textarea{
    width: 225px;
  }
  .filenameclass a{
    font-size: 14px;
  }
  .avatar2{
    position: relative;
    top:-50px;
    margin-bottom: -50px;
  }
  .avatar2 li{
    background-color: #f3e5f5;
  }

  #myTable {
    margin-left: 60px;
  }
       .timeDisp {
            color: #7e57c2;
            font-size: 10px;
        }
        #expiry {
        	height: 60px;
        }
        .avatar2 {
          margin-left: 200px;
        }
        #search-box {
          margin-left: 60px;
        }

        </style>
</head>

<body class="profile-page">
	<nav class="navbar navbar-transparent navbar-fixed-top navbar-color-on-scroll">
    	<div class="container">
        	<!-- Brand and toggle get grouped for better mobile display -->
        	<div class="navbar-header">
        		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example">
            		<span class="sr-only">Toggle navigation</span>
		            <span class="icon-bar"></span>
		            <span class="icon-bar"></span>
		            <span class="icon-bar"></span>
        		</button>
        
        	</div>

        			<div class="collapse navbar-collapse" id="navigation-example">
        				<ul class="nav navbar-nav navbar-center">
        				
              <a href="/search"><i class="material-icons"  tooltip="Search">search</i></a>
    				</ul>
        				<ul class="nav navbar-nav navbar-right">
        				
        			 <li>
		            	<a class="btn btn-simple btn-white btn-just-icon" href="/events"><i class="material-icons"> home</i></a>
		            </li>
		             
		           <li>
                  <a class="btn btn-simple btn-white btn-just-icon" href="/events"><i class="material-icons">event</i></a>
                </li>
		            <li>
                  <a class="btn btn-simple btn-white btn-just-icon" href="/"><i class="material-icons">message</i></a>
                </li>
        		</ul>
        	</div>
    	</div>
    </nav>

    <div class="wrapper">
		<div class="header header-filter" style="background-image: url('/assets/img/photo-1423655156442-ccc11daa4e99.jpg');"></div>

		<div class="main main-raised">
			<div class="profile-content">
	            <div class="container">
	                <div class="row">
                    <div class="col-md-2">
	                    <div class="profile">
	                        <div class="avatar">
	                         
	                        </div>
	                        <div class="name">
	                            <h3 class="title" id="name_put"></h3>
								<h6 id="designation_put"></h6>
								<h5 id="email_put"></h5>
	                        </div>
	                    </div>
	                
	                <div class="description text-center">
                        <p id="bio_put"> </p>
	                </div>
                  </div>
					
						<div class="col-md-8 ">
							<div class="col-sm-10 text-left"> 
              <div class="row" id="search-box">
              <div class="input-group" id="commentdiv">
                    <span class="input-group-addon">
                      <i class="material-icons">search</i>
                    </span>
                       <input type="text" id="myInput" class="form-control" onkeyup="searchFunction()" placeholder="Search for names.." title="Type in a name">
                       <input name="group1" type="radio" id="name_radio" checked="checked">
                       <label for="name_radio">By Name</label>
                       <input name="group1" type="radio" id="tag_radio">
                       <label for="tag_radio">By Tag</label>
                       <input name="group1" type="radio" id="to_radio">
                       <label for="to_radio">By Recepient</label>
                       <input name="group1" type="radio" id="from_radio">
                       <label for="from_radio">By Sender</label>
                </div>
              </div>
             <table id="myTable" class="table table-hover">
                     <thead>
                            <th>#</th>
                            <th>Filename</th>
                            <th>File Type</th>
                            <th>Tag</th>
                            <th>Insert Time</th>
                            <th>Expire Time</th>
                            <th>From</th>
                            <th>To</th>
                     </thead>
                     <tbody id="files">
                            
                     </tbody>
              </table>
    </div>
							<!-- End Profile Tabs -->
						</div>
	                </div>

	            </div>
	        </div>
		</div>

    </div>


</body>
	<!--   Core JS Files   -->
	<script src="../assets/js/jquery.min.js" type="text/javascript"></script>
	<script src="../assets/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="../assets/js/material.min.js"></script>

	<!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
	<script src="../assets/js/nouislider.min.js" type="text/javascript"></script>

	<!--  Plugin for the Datepicker, full documentation here: http://www.eyecon.ro/bootstrap-datepicker/ -->
	<script src="../assets/js/bootstrap-datepicker.js" type="text/javascript"></script>

	<!-- Control Center for Material Kit: activating the ripples, parallax effects, scripts from the example pages etc -->
	<script src="../assets/js/material-kit.js" type="text/javascript"></script>

</html>
<script type="text/javascript">
// Using jQuery.



function getUrlVars() {
    var vars = {};
    var parts = window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function(m,key,value) {
    vars[key] = value;
    });
    return vars;
}
  
    var rowVar = <%- JSON.stringify(row) %>;
    var filenameFull = <%- JSON.stringify(filenameFull) %>;
    console.log('<img alt="" src="images/profilePics/'+filenameFull+'">');
    $( ".avatar" ).html('<img alt="Circle Image" class="img-circle img-responsive img-raised" src="images/profilePics/'+filenameFull+'">');

    $( "#name_put" ).html("<b>"+rowVar.name+"</b>");
    $( "#email_put" ).html("<b>"+rowVar.email+"</b>");
     $( "#bio_put" ).html("<b>"+rowVar.bio+"</b>");
    $( "#designation_put" ).html("<b>"+rowVar.designation+"</b>");
   // $( "#station_put" ).html("<b>"+rowVar.station+"</b>");
    var vars = getUrlVars();
  
    //$( "div.all-contents" ).load("views/"+vars['page']+".html");
    

  </script>

  <script type="text/javascript">
var toRow = null;
var ddate = null;
var filesSent = <%- JSON.stringify(filesSent) %>;
var allrowVar = <%- JSON.stringify(allrows) %>;



function getRowById(allrowVar, userid){
     for(var i=allrowVar.length-1; i>=0; i--){
        if(allrowVar[i].userID == userid){
            toRow = allrowVar[i];
            break;
        }
     }
}

function getRowById2(userid){
	var allrowVar2 = <%- JSON.stringify(allrows) %>;
     for(var i=allrowVar2.length-1; i>=0; i--){
        if(allrowVar[i].userID == userid){
            return allrowVar2[i];
        }
     }
     return null;
}


// //////////////////////////////////////////////////////////////////////////////////////////////////
          function _arrayBufferToBase64( buffer ) {
                var binary = '';
                var bytes = new Uint8Array( buffer );
                var len = bytes.byteLength;
                for (var i = 0; i < len; i++) {
                    binary += String.fromCharCode( bytes[ i ] );
                }
                return window.btoa( binary );
            }
            function extractExtension(filename){
              var patt1 = /\.([0-9a-z]+)(?:[\?#]|$)/i;
                   var extension1 = (filename).match(patt1);
                   var extension = extension1[1];
                   return extension;
            }

    
    function searchFunction() {
  // Declare variables 
      var input, filter, table, tr, td, i;
      input = document.getElementById("myInput");
      filter = input.value.toUpperCase();
      table = document.getElementById("myTable");
      tr = table.getElementsByTagName("tr");
      var isName = true;
      var isTo = false;
      var isFrom = false;
      var isTag = false;
      if($('#name_radio').is(':checked')) {
            isName = true;
            isTo = false;
           isFrom = false;
           isTag = false;
      }else if($('#to_radio').is(':checked')){
            isName = false;
            isTo = true;
           isFrom = false;
           isTag = false;
      }else if($('#from_radio').is(':checked')){
            isName = false;
            isTo = false;
            isTag = false;
           isFrom = true;
      }else if($('#tag_radio').is(':checked')){
          isName = false;
            isTo = false;
            isTag = true;
           isFrom = false;
      }
  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
       if(isName){
           td = tr[i].getElementsByTagName("td")[1];
           if (td) {
             if (td.getElementsByTagName("a")[0].innerHTML.toUpperCase().indexOf(filter) > -1) {
               tr[i].style.display = "";
             } else {
               tr[i].style.display = "none";
             }
           } 
       }else if(isTo){
              td = tr[i].getElementsByTagName("td")[7];
           if (td) {
              console.log(td.innerHTML);
             if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
               tr[i].style.display = "";
             } else {
               tr[i].style.display = "none";
             }
           } 
       }else if(isFrom){
              td = tr[i].getElementsByTagName("td")[6];
           if (td) {
              console.log(td.innerHTML);
             if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
               tr[i].style.display = "";
             } else {
               tr[i].style.display = "none";
             }
           } 
       }else if(isTag){
              td = tr[i].getElementsByTagName("td")[3];
           if (td) {
              console.log(td.innerHTML);
             if (td.innerHTML.toUpperCase().indexOf(filter) > -1) {
               tr[i].style.display = "";
             } else {
               tr[i].style.display = "none";
             }
           } 
       }
  }
}
function getRowById2(userid){
  var allrowVar2 = <%- JSON.stringify(allrows) %>;
     for(var i=allrowVar2.length-1; i>=0; i--){
        if(allrowVar[i].userID == userid){
            return allrowVar2[i];
        }
     }
     return null;
}
function dateSQLToJS(datein){
    var tt = datein.split(/[- :]/);
    if(parseInt(tt[4])>=30){
        tt[3]=(parseInt(tt[3]) + 6) +"";
        tt[4]=""+((parseInt(tt[4])+30)%60);
    }else{
        tt[3]=(parseInt(tt[3])+5)+"";
        tt[4]=(parseInt(tt[4])+30)+"";
    }
    return new Date(Date.UTC(tt[0], tt[1]-1, tt[2], tt[3], tt[4], tt[5]));
}
var filesSent =  <%- JSON.stringify(filesSent) %>
 // var filesSent = [];
 for (var i=0; i<filesSent.length; i++){
        $('#files').append($('<tr>').html('<td>'+(i+1)+'</td><td><a href="/images/tempfiles/'+filesSent[i].downloadlink+'" target="_blank">'+filesSent[i].filename+'</td><td>'+(filesSent[i].fileextension).toUpperCase()+'</td><td>'+(filesSent[i].filetag)+'</td><td>'+dateSQLToJS((filesSent[i].insertTime).replace('T', ' ').replace('Z', ''))+'</td><td>'+dateSQLToJS((filesSent[i].expireTime).replace('T', ' ').replace('Z', ''))+'</td><td>'+getRowById2(filesSent[i].fromID).name+'</td><td>'+getRowById2(filesSent[i].toID).name+'</td>'));
 }

</script>
